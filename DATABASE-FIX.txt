# Database Table Fix - AI Podcast Generator

## Problem
You're seeing this error:
```
WordPress database error Table 'xxx.xxx_aipg_generations' doesn't exist
```

## Quick Fix (Choose One Method)

### Method 1: Use Settings Page (Easiest)

1. Go to **WordPress Admin > AI Podcasts > Settings**
2. You'll see a red error box that says "Database Error: Required database table is missing!"
3. Click the **"Create Database Table"** button
4. You should see a success message
5. Try generating a podcast again

### Method 2: Deactivate and Reactivate

1. Go to **Plugins** in WordPress admin
2. **Deactivate** AI Podcast Generator
3. **Activate** it again
4. The table should be created automatically

### Method 3: Manual SQL (Advanced)

If the above methods don't work, run this SQL manually in phpMyAdmin:

```sql
CREATE TABLE IF NOT EXISTS wp_aipg_generations (
    id bigint(20) NOT NULL AUTO_INCREMENT,
    post_id bigint(20) DEFAULT NULL,
    status varchar(50) DEFAULT 'pending',
    script_data longtext,
    audio_chunks longtext,
    final_audio_url varchar(500) DEFAULT NULL,
    settings longtext,
    error_log longtext,
    created_at datetime DEFAULT CURRENT_TIMESTAMP,
    updated_at datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    PRIMARY KEY  (id),
    KEY post_id (post_id),
    KEY status (status)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

**IMPORTANT**: Replace `wp_` with your actual WordPress table prefix!

To find your prefix:
1. Open `wp-config.php`
2. Look for: `$table_prefix = 'xxx_';`
3. Use that prefix in the SQL above

### Method 4: PHP Code

Add this to your theme's `functions.php` temporarily:

```php
add_action('init', function() {
    if (class_exists('AIPG_Database')) {
        AIPG_Database::create_tables();
        error_log('AIPG: Manually created database table');
    }
}, 999);
```

Visit any page on your site, then remove this code.

## Verification

After trying any method above:

1. Go to **AI Podcasts > Settings**
2. Look for the green success message: "âœ… Database table exists and is ready."
3. If you see it, the problem is fixed!

## Prevention

The updated plugin version now includes:
- Automatic database check on every load
- Manual creation button in settings
- Better error logging
- Improved activation hooks

## Still Having Issues?

Check your WordPress error log (usually in `wp-content/debug.log`) for:
```
AIPG: Database table created successfully
```

or

```
AIPG: Failed to create database table
```

If you see the failure message, contact your hosting provider as there may be MySQL permission issues.

---

The new plugin version automatically checks and creates the table if missing, so this should be a one-time fix!
